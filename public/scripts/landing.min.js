document.addEventListener("DOMContentLoaded",()=>{const hash=new Hashes.SHA256;sessionStorage.removeItem("username"),sessionStorage.removeItem("token"),sessionStorage.removeItem("color"),sessionStorage.removeItem("font");const usernameForm=document.getElementById("username-form"),usernameInput=document.getElementById("username-input");usernameForm.addEventListener("submit",e=>{e.preventDefault();let username=e.target.elements["username-input"].value;const socket=io();socket.on("connect",()=>{socket.emit("checkUserExists",username),socket.on("userExists",userExists=>{if(userExists)validateForm("Username already exists");else{const color=document.querySelector(".selected").style.backgroundColor,font=document.getElementById("font-picker").value;if(console.log(font),username=username.replace(/</g,"&lt;").replace(/>/g,"&gt;").trim(),username.length>10||username.length<=0)return void validateForm("Username has to be between 1 and 10 characters");sessionStorage.setItem("username",username),sessionStorage.setItem("token",hash.hex(username)),sessionStorage.setItem("color",color),sessionStorage.setItem("font",font),window.location.href="/public"}})})}),usernameInput.addEventListener("input",e=>{validateForm()}),$(".color").on("click",e=>{$(".selected").removeClass("selected"),e.target.classList.add("selected")}),document.getElementById("font-picker").addEventListener("change",e=>{document.getElementById("font-picker").style.fontFamily=e.target.value});const validateForm=err=>{const joinBtn=document.getElementById("join-btn"),errorFeedback=document.getElementById("error-feedback");null==err?(usernameInput.classList.remove("invalid"),joinBtn.classList.remove("invalid"),errorFeedback.classList.remove("show")):(usernameInput.classList.add("invalid"),joinBtn.classList.add("invalid"),errorFeedback.innerHTML=err,errorFeedback.classList.add("show"))}});